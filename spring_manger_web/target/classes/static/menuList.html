<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>菜单列表</title>
    <link rel="stylesheet" href="layui/css/layui.css">
</head>
<body>
<div class="xm">
    <div class="xm-d1">
        <p class="xm-d1-p">菜单管理</p>
    </div>

    <div class="xm-d2">

        <div class="xm-d2-hang2">
            <table id="permissionTable" class="layui-table" lay-filter="permissionTable"></table>
        </div>
    </div>

    <script type="text/javascript" src="assets/libs/jquery-3.2.1.min.js"></script>
    <script src="layui/layui.js" type="text/javascript"></script>
    <script type="text/javascript" src="js/jquery.cookie.js"></script>

<script>
    layui.config({
        base:'layui/'
    }).extend({
        treetable:"treetable-lay/treetable"
    });
    layui.use(['treetable', 'table', 'layer'], function () {
        var $ = layui.$;
        var table = layui.table;
        var layer = layui.layer;
        var treetable = layui.treetable;
        var menuName ="";
        var status = -1;
        var token = $.cookie('token');
        init();
        function init(){
            $.ajax({
                url: 'http://localhost:8182/sumer/menuList',
                method:"post",
                data:{
                    "menuName":menuName,
                    "status":status
                },
                dataType:"json",
                beforeSend: function(xhr){
                    xhr.setRequestHeader('token',token);
                },
                success:function(data){

                    if(data.code !='200'){
                        alert(JSON.stringify(data.message));
                        location.href="login.html";
                    }
                    treetables(data.data);
                    alert(JSON.stringify(data));
                },error:function(data){
                    alert("发送异常");
                }
            })
        }
        function treetables(data) {

            treetable.render({
                treeColIndex: 1,          // treetable新增参数
                treeSpid: 0,             // treetable新增参数
                treeIdName: 'id',       // treetable新增参数
                treePidName: 'parentId',     // treetable新增参数
                treeDefaultClose: true,   // treetable新增参数
                treeLinkage: true,        // treetable新增参数
                elem: '#permissionTable',
                data: data,
                type: "post",
                cols: [[
                    {type: 'numbers'},
                    {field: 'id', title: 'id'},
                    {field: 'name', title: 'name'},
                    {field: 'sex', title: 'sex'},
                    {field: 'pid', title: 'pid'},
                ]]
            });
        }
    })
</script>
</div>
</body>
</html>