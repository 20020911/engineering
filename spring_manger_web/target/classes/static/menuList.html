<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>菜单列表</title>
    <link rel="stylesheet" href="layui/css/layui.css">
</head>
<body>
<div class="xm">
    <div class="xm-d1">
        <p class="xm-d1-p">菜单管理</p>
    </div>

    <div class="xm-d2">
        <div class="xm-d2-hang2">
            <table id="table1" class="layui-table" lay-filter="table1"></table>
        </div>
    </div>

    <script type="text/javascript" src="assets/libs/jquery-3.2.1.min.js"></script>
    <script src="layui/layui.js" type="text/javascript"></script>
    <script type="text/javascript" src="js/jquery.cookie.js"></script>

<script>
    layui.config({
        base:'layui/'
    }).extend({
        treetable:"treetable-lay/treetable"
    });
    layui.use(['treetable', 'table', 'layer'], function () {
        var $ = layui.$;
        var table = layui.table;
        var layer = layui.layer;
        var treetable = layui.treetable;
        var menuName ="";
        var status = -1;
        var token = $.cookie('token');
        init();
        function init(){
            $.ajax({
                url: 'http://localhost:8182/sumer/menuList',
                method:"post",
                data:{
                    "menuName":menuName,
                    "status":status
                },
                dataType:"json",
                beforeSend: function(xhr){
                    xhr.setRequestHeader('token',token);
                },
                success:function(data){
                    if(data.code =="4001"){
                        alert(JSON.stringify(data.message));
                        location.href="login.html";
                    }
                    trtable(data.data);
                },error:function(data){
                    alert("发送异常");
                }
            })
        }


        function trtable(data) {
            layer.load(2);
            treetable.render({
                data:data,
                isPidData: true,
                treeColIndex: 1,          // treetable新增参数
                treeSpid: 0,             // treetable新增参数
                treeIdName: 'id',       // treetable新增参数
                treePidName: 'parentId',     // treetable新增参数
                treeDefaultClose: true,   // treetable新增参数
                treeLinkage: true,        // treetable新增参数
                page:"false",
                elem: '#table1',
                cols: [[
                    {type: 'radio'},
                    {field: 'id', title: 'id'},
                    {field: 'menuName', title: 'menuName'},
                    {field: 'parentId', title: 'parentId'},
                    {field: 'url', title: 'url'},
                    {field: 'createdDate', title: 'createdDate'},
                ]],done: function () {
                    layer.closeAll('loading');
                },error:function(da){
                    alert("发送异常");
                }
            });
        }
    })
</script>
</div>
</body>
</html>